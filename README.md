hack captcha by cnn with keras
=========================================

# 奕文計畫
![image](https://github.com/cbc106013/captcha_cnn/blob/master/acc94%25.png)

## Reference Material at Issues
<p>captcha.jpg in</p>
<p>https://drive.google.com/drive/folders/1hGFCpwOAyu1PcSXICK2VFgi7f23vX0cx?usp=sharing</p>


# 2019/01/16(更新)============================
100%
![image](https://github.com/cbc106013/captcha_cnn/blob/master/nptu_captch_kigison%26culdo/train100%25.png)

# model summary============================
__________________________________________________________________________________________________  
Layer (type)                    Output Shape         Param #     Connected to                       
==================================================================================================  
Input (InputLayer)              (None, 35, 95, 1)    0                                              
__________________________________________________________________________________________________  
conv2d_1 (Conv2D)               (None, 35, 95, 8)    80          Input[0][0]                        
__________________________________________________________________________________________________  
conv2d_2 (Conv2D)               (None, 33, 93, 8)    584         conv2d_1[0][0]                     
__________________________________________________________________________________________________  
batch_normalization_1 (BatchNor (None, 33, 93, 8)    32          conv2d_2[0][0]                     
__________________________________________________________________________________________________  
conv2d_3 (Conv2D)               (None, 33, 93, 16)   1168        batch_normalization_1[0][0]        
__________________________________________________________________________________________________  
conv2d_4 (Conv2D)               (None, 31, 91, 16)   2320        conv2d_3[0][0]                     
__________________________________________________________________________________________________  
batch_normalization_2 (BatchNor (None, 31, 91, 16)   64          conv2d_4[0][0]                     
__________________________________________________________________________________________________  
conv2d_5 (Conv2D)               (None, 31, 91, 32)   4640        batch_normalization_2[0][0]         
__________________________________________________________________________________________________  
conv2d_6 (Conv2D)               (None, 29, 89, 32)   9248        conv2d_5[0][0]                     
__________________________________________________________________________________________________  
batch_normalization_3 (BatchNor (None, 29, 89, 32)   128         conv2d_6[0][0]                     
__________________________________________________________________________________________________  
max_pooling2d_1 (MaxPooling2D)  (None, 14, 44, 32)   0           batch_normalization_3[0][0]        
__________________________________________________________________________________________________  
dropout_1 (Dropout)             (None, 14, 44, 32)   0           max_pooling2d_1[0][0]              
__________________________________________________________________________________________________  
conv2d_7 (Conv2D)               (None, 14, 44, 64)   18496       dropout_1[0][0]                    
__________________________________________________________________________________________________  
conv2d_8 (Conv2D)               (None, 12, 42, 64)   36928       conv2d_7[0][0]                      
__________________________________________________________________________________________________  
batch_normalization_4 (BatchNor (None, 12, 42, 64)   256         conv2d_8[0][0]                      
__________________________________________________________________________________________________   
conv2d_9 (Conv2D)               (None, 12, 42, 128)  73856       batch_normalization_4[0][0]         
__________________________________________________________________________________________________   
conv2d_10 (Conv2D)              (None, 10, 40, 128)  147584      conv2d_9[0][0]                      
__________________________________________________________________________________________________   
batch_normalization_5 (BatchNor (None, 10, 40, 128)  512         conv2d_10[0][0]                      
__________________________________________________________________________________________________   
max_pooling2d_2 (MaxPooling2D)  (None, 5, 20, 128)   0           batch_normalization_5[0][0]          
__________________________________________________________________________________________________   
dropout_2 (Dropout)             (None, 5, 20, 128)   0           max_pooling2d_2[0][0]               
__________________________________________________________________________________________________   
conv2d_11 (Conv2D)              (None, 3, 18, 256)   295168      dropout_2[0][0]                      
__________________________________________________________________________________________________    
max_pooling2d_3 (MaxPooling2D)  (None, 1, 9, 256)    0           conv2d_11[0][0]                     
__________________________________________________________________________________________________   
dropout_3 (Dropout)             (None, 1, 9, 256)    0           max_pooling2d_3[0][0]               
__________________________________________________________________________________________________   
flatten_1 (Flatten)             (None, 2304)         0           dropout_3[0][0]                     
__________________________________________________________________________________________________   
digit1 (Dense)                  (None, 10)           23050       flatten_1[0][0]                     
__________________________________________________________________________________________________   
digit2 (Dense)                  (None, 10)           23050       flatten_1[0][0]                    
__________________________________________________________________________________________________  
digit3 (Dense)                  (None, 10)           23050       flatten_1[0][0]                    
__________________________________________________________________________________________________  
digit4 (Dense)                  (None, 10)           23050       flatten_1[0][0]                    
==================================================================================================  
Total params: 683,264  
Trainable params: 682,768  
Non-trainable params: 496  
__________________________________________________________________________________________________  

## 目標資料夾：nptu_captch_kigison&culdo
* DEMO.mp4---------------->DEMO影片
* Demo.py----------------->載入訓練好的模型進行線上預測
* captch_project_test.py-->將原始影像經影像處理去背後另外存檔
* captcha_model.py-------->training code
* data.rar---------------->所有照片(含訓練及測試)
* img2arr.py-------------->將所有照片轉成np.arr以便餵給model
* nptu_captch.csv--------->所有照片的解答(流水號，千位數字，百位數字，十位數字，個位數字)
* nptu_captch.h5---------->此次100%的model存檔
* nptu_captch.npy--------->從照片轉換後的np.arr
* prediction_captcha.py--->載入訓練好的模型進行離線預測
* train100%.png----------->100%截圖

## 製作思路
* dataset----->先人工將300張校務行政系統的驗證碼標記，再將該驗證碼去背另存成一份增加成功率，共600張影像。
* train------->使用不切割形式，以單一模型做四層dense分別判斷對應數字。再使用model.fit調整最佳化。
* prediction-->將驗證碼下載後灰階化直接餵入訓練好的模型進行預測。
* DEMO-------->將prediction改以線上執行

## using: 
* tensorflow-gpu==1.11.0
* keras==2.2.2
* windows 10
